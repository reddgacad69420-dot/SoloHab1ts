<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <meta name="description" content="SoloHabits - Your personal gamified habit tracker">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SoloHabits">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <title>SoloHabits</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- App Container -->
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <span class="app-logo">‚ú®</span>
                <h1 class="app-title">SoloHabits</h1>
            </div>
            <div class="header-right">
                <div class="level-badge" id="headerLevel">
                    <span class="level-icon">‚≠ê</span>
                    <span class="level-num">1</span>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Home View -->
            <section id="homeView" class="view active">
                <div class="week-calendar-container">
                    <div class="week-calendar" id="homeWeekCalendar">
                        <!-- Week days will be rendered here -->
                    </div>
                </div>

                <div class="xp-bar-container">
                    <div class="xp-info">
                        <span class="xp-level">Level <span id="currentLevel">1</span></span>
                        <span class="xp-text"><span id="currentXP">0</span> / <span id="nextLevelXP">100</span> XP</span>
                    </div>
                    <div class="xp-bar">
                        <div class="xp-progress" id="xpProgress" style="width: 0%"></div>
                    </div>
                </div>

                <div class="habits-header">
                    <h2>Today's Habits</h2>
                    <div class="habits-filter">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="daily">Daily</button>
                        <button class="filter-btn" data-filter="weekly">Weekly</button>
                    </div>
                </div>

                <div class="habits-list" id="habitsList">
                    <!-- Habits will be rendered here -->
                </div>

                <div class="empty-state" id="emptyHabits" style="display: none;">
                    <span class="empty-icon">üéØ</span>
                    <h3>No habits yet</h3>
                    <p>Start building better habits today!</p>
                    <button class="btn btn-primary" onclick="UI.showAddHabitModal()">Add Your First Habit</button>
                </div>

                <button class="fab" id="addHabitBtn" aria-label="Add habit">
                    <span>+</span>
                </button>
            </section>

            <!-- Profile View -->
            <section id="profileView" class="view">
                <div class="profile-header">
                    <div class="avatar-container" id="avatarContainer">
                        <span class="avatar" id="profileAvatar">üòä</span>
                        <button class="avatar-edit" onclick="UI.showAvatarPicker()">‚úèÔ∏è</button>
                    </div>
                    <div class="profile-name-container">
                        <h2 class="profile-name" id="profileName">User</h2>
                        <button class="edit-name-btn" onclick="UI.editUsername()">‚úèÔ∏è</button>
                    </div>
                    <p class="profile-joined">Member since <span id="joinDate">-</span></p>
                </div>

                <div class="profile-level-card">
                    <div class="level-display">
                        <span class="big-level">Level</span>
                        <span class="big-level-num" id="profileLevelNum">1</span>
                    </div>
                    <div class="xp-bar large">
                        <div class="xp-progress" id="profileXpProgress" style="width: 0%"></div>
                    </div>
                    <p class="xp-detail"><span id="profileCurrentXP">0</span> / <span id="profileNextXP">100</span> XP</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-icon">‚ö°</span>
                        <span class="stat-value" id="totalXP">0</span>
                        <span class="stat-label">Total XP</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">‚úÖ</span>
                        <span class="stat-value" id="totalCompleted">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üî•</span>
                        <span class="stat-value" id="bestStreak">0</span>
                        <span class="stat-label">Best Streak</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üèÜ</span>
                        <span class="stat-value" id="achievementCount">0</span>
                        <span class="stat-label">Achievements</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üìÖ</span>
                        <span class="stat-value" id="usageDays">0</span>
                        <span class="stat-label">Days Active</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üìä</span>
                        <span class="stat-value" id="avgCompletion">0%</span>
                        <span class="stat-label">Avg. Daily</span>
                    </div>
                </div>
            </section>

            <!-- Achievements View -->
            <section id="achievementsView" class="view">
                <div class="achievements-header">
                    <h2>Achievements</h2>
                    <p class="achievements-subtitle"><span id="unlockedCount">0</span> / <span id="totalAchievements">0</span> Unlocked</p>
                </div>
                <div class="achievements-grid" id="achievementsList">
                    <!-- Achievements will be rendered here -->
                </div>
            </section>

            <!-- Stats View -->
            <section id="statsView" class="view">
                <h2>Statistics</h2>
                
                <div class="stats-section">
                    <h3>Weekly Overview</h3>
                    <div class="week-chart" id="weekChart">
                        <!-- Week days will be rendered here -->
                    </div>
                </div>

                <div class="stats-section">
                    <h3>Habit Performance</h3>
                    <div class="habit-stats-list" id="habitStatsList">
                        <!-- Habit stats will be rendered here -->
                    </div>
                </div>

                <div class="stats-section">
                    <h3>Streaks Leaderboard</h3>
                    <div class="streaks-list" id="streaksList">
                        <!-- Streaks will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="settingsView" class="view">
                <h2>Settings</h2>

                <div class="settings-group">
                    <h3>Appearance</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <span class="setting-icon">üé®</span>
                            <span class="setting-label">Theme</span>
                        </div>
                        <select id="themeSelect" class="setting-select" onchange="Settings.setTheme(this.value)">
                            <option value="system">System</option>
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <span class="setting-icon">üî§</span>
                            <span class="setting-label">Font Size</span>
                        </div>
                        <select id="fontSizeSelect" class="setting-select" onchange="Settings.setFontSize(this.value)">
                            <option value="small">Small</option>
                            <option value="medium">Medium</option>
                            <option value="large">Large</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Notifications</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <span class="setting-icon">üîî</span>
                            <span class="setting-label">Enable Notifications</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="notificationsToggle" onchange="Settings.toggleNotifications(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <span class="setting-icon">‚è∞</span>
                            <span class="setting-label">Daily Reminder</span>
                        </div>
                        <input type="time" id="reminderTime" class="setting-input" value="20:00" onchange="Settings.setReminderTime(this.value)">
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <span class="setting-icon">üîä</span>
                            <span class="setting-label">Sound Effects</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="soundToggle" onchange="Settings.toggleSound(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <button class="btn btn-secondary" onclick="Notifications.testNotification()">
                        Test Notification
                    </button>
                </div>

                <div class="settings-group">
                    <h3>Data Management</h3>
                    <div class="data-buttons">
                        <button class="btn btn-secondary" onclick="Settings.exportData()">
                            üì§ Export Data
                        </button>
                        <button class="btn btn-secondary" onclick="Settings.importData()">
                            üì• Import Data
                        </button>
                    </div>
                    <button class="btn btn-danger" onclick="Settings.resetData()">
                        üóëÔ∏è Reset All Data
                    </button>
                </div>

                <div class="settings-group">
                    <h3>About</h3>
                    <div class="about-info">
                        <p><strong>SoloHabits</strong> v1.0.0</p>
                        <p>Your personal gamified habit tracker</p>
                        <p class="about-privacy">üîí All data stored locally on your device</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-view="homeView">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-item" data-view="profileView">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">Profile</span>
            </button>
            <button class="nav-item" data-view="achievementsView">
                <span class="nav-icon">üèÜ</span>
                <span class="nav-label">Badges</span>
            </button>
            <button class="nav-item" data-view="statsView">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">Stats</span>
            </button>
            <button class="nav-item" data-view="settingsView">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>
    </div>

    <!-- Add/Edit Habit Modal -->
    <div class="modal" id="habitModal">
        <div class="modal-overlay" onclick="UI.closeModal('habitModal')"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="habitModalTitle">Add New Habit</h3>
                <button class="modal-close" onclick="UI.closeModal('habitModal')">&times;</button>
            </div>
            <form id="habitForm" onsubmit="Habits.saveHabit(event)">
                <input type="hidden" id="habitId">
                
                <div class="form-group">
                    <label for="habitName">Habit Name *</label>
                    <input type="text" id="habitName" required placeholder="e.g., Morning Workout" maxlength="50">
                </div>

                <div class="form-group">
                    <label for="habitDescription">Description</label>
                    <textarea id="habitDescription" placeholder="Optional description..." maxlength="150"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Icon</label>
                        <div class="icon-picker" id="iconPicker">
                            <button type="button" class="selected-icon" id="selectedIcon" onclick="UI.toggleIconPicker()">üí™</button>
                            <div class="icon-dropdown" id="iconDropdown">
                                <div class="icon-grid">
                                    <!-- Icons will be rendered here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Color</label>
                        <div class="color-picker" id="colorPicker">
                            <button type="button" class="color-option selected" data-color="#6366f1" style="background: #6366f1"></button>
                            <button type="button" class="color-option" data-color="#ec4899" style="background: #ec4899"></button>
                            <button type="button" class="color-option" data-color="#10b981" style="background: #10b981"></button>
                            <button type="button" class="color-option" data-color="#f59e0b" style="background: #f59e0b"></button>
                            <button type="button" class="color-option" data-color="#3b82f6" style="background: #3b82f6"></button>
                            <button type="button" class="color-option" data-color="#8b5cf6" style="background: #8b5cf6"></button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Frequency</label>
                    <div class="frequency-options">
                        <button type="button" class="freq-btn active" data-freq="daily">Daily</button>
                        <button type="button" class="freq-btn" data-freq="weekly">Weekly</button>
                        <button type="button" class="freq-btn" data-freq="custom">Custom</button>
                    </div>
                </div>

                <div class="form-group" id="customDaysGroup" style="display: none;">
                    <label>Select Days</label>
                    <div class="days-picker">
                        <button type="button" class="day-btn" data-day="0">S</button>
                        <button type="button" class="day-btn" data-day="1">M</button>
                        <button type="button" class="day-btn" data-day="2">T</button>
                        <button type="button" class="day-btn" data-day="3">W</button>
                        <button type="button" class="day-btn" data-day="4">T</button>
                        <button type="button" class="day-btn" data-day="5">F</button>
                        <button type="button" class="day-btn" data-day="6">S</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Reminder (Optional)</label>
                    <div class="reminder-setting">
                        <label class="toggle small">
                            <input type="checkbox" id="habitReminderToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <input type="time" id="habitReminderTime" value="09:00" disabled>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="UI.closeModal('habitModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Habit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Avatar Picker Modal -->
    <div class="modal" id="avatarModal">
        <div class="modal-overlay" onclick="UI.closeModal('avatarModal')"></div>
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Choose Avatar</h3>
                <button class="modal-close" onclick="UI.closeModal('avatarModal')">&times;</button>
            </div>
            <div class="avatar-grid" id="avatarGrid">
                <!-- Avatars will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Confirm Dialog -->
    <div class="modal" id="confirmModal">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="confirmTitle">Confirm</h3>
            </div>
            <p id="confirmMessage">Are you sure?</p>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="UI.closeConfirm(false)">Cancel</button>
                <button class="btn btn-danger" onclick="UI.closeConfirm(true)">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Level Up Modal -->
    <div class="modal" id="levelUpModal">
        <div class="modal-overlay" onclick="UI.closeModal('levelUpModal')"></div>
        <div class="modal-content modal-small level-up-content">
            <div class="level-up-animation">
                <span class="level-up-icon">üéâ</span>
                <h2>Level Up!</h2>
                <p class="level-up-text">You reached</p>
                <span class="new-level" id="newLevelDisplay">Level 2</span>
                <button class="btn btn-primary" onclick="UI.closeModal('levelUpModal')">Awesome!</button>
            </div>
        </div>
    </div>

    <!-- Achievement Unlock Modal -->
    <div class="modal" id="achievementModal">
        <div class="modal-overlay" onclick="UI.closeModal('achievementModal')"></div>
        <div class="modal-content modal-small achievement-content">
            <div class="achievement-unlock-animation">
                <span class="achievement-icon" id="unlockedAchievementIcon">üèÜ</span>
                <h2>Achievement Unlocked!</h2>
                <p class="achievement-name" id="unlockedAchievementName">First Steps</p>
                <p class="achievement-desc" id="unlockedAchievementDesc">Complete your first habit</p>
                <button class="btn btn-primary" onclick="UI.closeModal('achievementModal')">Claim</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Install PWA Prompt -->
    <div class="install-prompt" id="installPrompt" style="display: none;">
        <div class="install-content">
            <span class="install-icon">üì±</span>
            <div class="install-text">
                <strong>Install SoloHabits</strong>
                <span>Add to home screen for the best experience</span>
            </div>
            <button class="btn btn-primary btn-small" id="installBtn">Install</button>
            <button class="install-close" onclick="UI.dismissInstallPrompt()">&times;</button>
        </div>
    </div>

    <!-- Hidden file input for import -->
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="Settings.handleImport(event)">

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/xp.js"></script>
    <script src="js/streaks.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/habits.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
